function mapCountry(n){switch(n){case"Singapore":return"sg";case"Hong Kong":return"hk";case"Taiwan":return"tw";case"Australia":return"au"}}function processResults(n,o){$("#iphone6plus").empty(),$("#iphone6").empty(),countryIPhoneData=n[o];for(var a=0;a<countryIPhoneData.length;a++)s='<div class="col-sm-4">',s+="No"==countryIPhoneData[a].availability?'<div class="panel panel-danger"><div class="panel-heading"><h3 class="panel-title">Unavailable</h3></div>':'<div class="panel panel-success"><div class="panel-heading"><h3 class="panel-title">Available</h3></div>',s+='<div class="panel-body">',s+="<strong>Colour:</strong> "+countryIPhoneData[a].colour+"<br>",s+="<strong>Capacity:</strong> "+countryIPhoneData[a].capacity+"<br>",s+="<strong>Price:</strong> $"+countryIPhoneData[a].price+"<br>",s+="</div></div></div>","iPhone 6 Plus"==countryIPhoneData[a].model?$("#iphone6plus").append(s):$("#iphone6").append(s)}function makeSockJSConnection(){var n=new SockJS("http://"+window.location.host+"/data");n.onopen=function(){console.log("SockJS connection opened.")},n.onmessage=function(n){data=$.parseJSON(n.data),country=$("ul.countries li.active").text(),processResults(data,mapCountry(country))},n.onerror=function(){},n.onclose=function(){console.log("SockJS connection closed.")}}$(document).ready(function(){$("ul.countries li a").click(function(){$("ul.countries li.active").removeClass("active"),$(this).parent("li").addClass("active");var n=$(this).text();processResults(rawData,mapCountry(n))}),setTimeout(makeSockJSConnection(),100)});